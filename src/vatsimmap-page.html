<html><head></head><body><div hidden="" by-polymer-bundler=""><link rel="import" href="pedro-toolbox-app.html"><script>(function(){"use strict";Polymer.IronJsonpLibraryBehavior={properties:{libraryLoaded:{type:Boolean,value:!1,notify:!0,readOnly:!0},libraryErrorMessage:{type:String,value:null,notify:!0,readOnly:!0}},observers:["_libraryUrlChanged(libraryUrl)"],_libraryUrlChanged:function(){this._isReady&&this.libraryUrl&&this._loadLibrary()},_libraryLoadCallback:function(c,d){c?(Polymer.Base._warn("Library load failed:",c.message),this._setLibraryErrorMessage(c.message)):(this._setLibraryErrorMessage(null),this._setLibraryLoaded(!0),this.notifyEvent&&this.fire(this.notifyEvent,d,{composed:!0}))},_loadLibrary:function(){a.require(this.libraryUrl,this._libraryLoadCallback.bind(this),this.callbackName)},ready:function(){this._isReady=!0,this.libraryUrl&&this._loadLibrary()}};var a={apiMap:{},require:function(c,d,e){var f=this.nameFromUrl(c);this.apiMap[f]||(this.apiMap[f]=new b(f,c,e)),this.apiMap[f].requestNotify(d)},nameFromUrl:function(c){return c.replace(/[\:\/\%\?\&\.\=\-\,]/g,"_")+"_api"}},b=function(c,d,e){if(this.notifiers=[],!e)if(0<=d.indexOf(this.callbackMacro))e=c+"_loaded",d=d.replace(this.callbackMacro,e);else return void(this.error=new Error("IronJsonpLibraryBehavior a %%callback%% parameter is required in libraryUrl"));this.callbackName=e,window[this.callbackName]=this.success.bind(this),this.addScript(d)};b.prototype={callbackMacro:"%%callback%%",loaded:!1,addScript:function(c){var d=document.createElement("script");d.src=c,d.onerror=this.handleError.bind(this);var e=document.querySelector("script")||document.body;e.parentNode.insertBefore(d,e),this.script=d},removeScript:function(){this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.script=null},handleError:function(){this.error=new Error("Library failed to load"),this.notifyAll(),this.cleanup()},success:function(){this.loaded=!0,this.result=Array.prototype.slice.call(arguments),this.notifyAll(),this.cleanup()},cleanup:function(){delete window[this.callbackName]},notifyAll:function(){this.notifiers.forEach(function(c){c(this.error,this.result)}.bind(this)),this.notifiers=[]},requestNotify:function(c){this.loaded||this.error?c(this.error,this.result):this.notifiers.push(c)}}})();</script><script>Polymer({is:'iron-jsonp-library',behaviors:[Polymer.IronJsonpLibraryBehavior],properties:{libraryUrl:String,callbackName:String,notifyEvent:String}});</script><script>Polymer({is:'google-maps-api',behaviors:[Polymer.IronJsonpLibraryBehavior],properties:{mapsUrl:{type:String,value:'https://maps.googleapis.com/maps/api/js?callback=%%callback%%'},apiKey:{type:String,value:''},clientId:{type:String,value:''},version:{type:String,value:'3.exp'},language:{type:String,value:''},signedIn:{type:Boolean,value:!1},notifyEvent:{type:String,value:'api-load'},libraryUrl:{type:String,computed:'_computeUrl(mapsUrl, version, apiKey, clientId, language, signedIn)'}},_computeUrl:function(a,b,c,d,e,f){var g=a+'&v='+b;if(g+='&libraries=drawing,geometry,places,visualization',c&&!d&&(g+='&key='+c),d&&(g+='&client='+d),!c&&!d){console.warn('No Google Maps API Key or Client ID specified. See https://developers.google.com/maps/documentation/javascript/get-api-key for instructions to get started with a key or client id.')}return e&&(g+='&language='+e),f&&(g+='&signed_in='+f),g},get api(){return google.maps}});</script><dom-module id="google-map-marker" assetpath="../bower_components/google-map/"><template><style>:host{display:none;}</style><slot></slot></template><script>(function(){function a(){this.draggable?this.dragHandler_=google.maps.event.addListener(this.marker,'dragend',b.bind(this)):(google.maps.event.removeListener(this.dragHandler_),this.dragHandler_=null)}function b(c){this.latitude=c.latLng.lat(),this.longitude=c.latLng.lng()}Polymer({is:'google-map-marker',properties:{marker:{type:Object,notify:!0},map:{type:Object,observer:'_mapChanged'},info:{type:Object,value:null},clickEvents:{type:Boolean,value:!1,observer:'_clickEventsChanged'},dragEvents:{type:Boolean,value:!1,observer:'_dragEventsChanged'},icon:{type:Object,value:null,observer:'_iconChanged'},mouseEvents:{type:Boolean,value:!1,observer:'_mouseEventsChanged'},zIndex:{type:Number,value:0,observer:'_zIndexChanged'},longitude:{type:Number,value:null,notify:!0},latitude:{type:Number,value:null,notify:!0},label:{type:String,value:null,observer:'_labelChanged'},animation:{type:String,value:null,observer:'_animationChanged'},open:{type:Boolean,value:!1,observer:'_openChanged'}},observers:['_updatePosition(latitude, longitude)'],detached:function(){this.marker&&(google.maps.event.clearInstanceListeners(this.marker),this._listeners={},this.marker.setMap(null)),this._contentObserver&&this._contentObserver.disconnect()},attached:function(){this.marker&&this.marker.setMap(this.map)},_updatePosition:function(){this.marker&&null!=this.latitude&&null!=this.longitude&&this.marker.setPosition(new google.maps.LatLng(parseFloat(this.latitude),parseFloat(this.longitude)))},_clickEventsChanged:function(){this.map&&(this.clickEvents?(this._forwardEvent('click'),this._forwardEvent('dblclick'),this._forwardEvent('rightclick')):(this._clearListener('click'),this._clearListener('dblclick'),this._clearListener('rightclick')))},_dragEventsChanged:function(){this.map&&(this.dragEvents?(this._forwardEvent('drag'),this._forwardEvent('dragend'),this._forwardEvent('dragstart')):(this._clearListener('drag'),this._clearListener('dragend'),this._clearListener('dragstart')))},_mouseEventsChanged:function(){this.map&&(this.mouseEvents?(this._forwardEvent('mousedown'),this._forwardEvent('mousemove'),this._forwardEvent('mouseout'),this._forwardEvent('mouseover'),this._forwardEvent('mouseup')):(this._clearListener('mousedown'),this._clearListener('mousemove'),this._clearListener('mouseout'),this._clearListener('mouseover'),this._clearListener('mouseup')))},_animationChanged:function(){this.marker&&this.marker.setAnimation(google.maps.Animation[this.animation])},_labelChanged:function(){this.marker&&this.marker.setLabel(this.label)},_iconChanged:function(){this.marker&&this.marker.setIcon(this.icon)},_zIndexChanged:function(){this.marker&&this.marker.setZIndex(this.zIndex)},_mapChanged:function(){this.marker&&(this.marker.setMap(null),google.maps.event.clearInstanceListeners(this.marker)),this.map&&this.map instanceof google.maps.Map&&this._mapReady()},_contentChanged:function(){this._contentObserver&&this._contentObserver.disconnect(),this._contentObserver=new MutationObserver(this._contentChanged.bind(this)),this._contentObserver.observe(this,{childList:!0,subtree:!0});var c=this.innerHTML.trim();c?(!this.info&&(this.info=new google.maps.InfoWindow,this.openInfoHandler_=google.maps.event.addListener(this.marker,'click',function(){this.open=!0}.bind(this)),this.closeInfoHandler_=google.maps.event.addListener(this.info,'closeclick',function(){this.open=!1}.bind(this))),this.info.setContent(c)):this.info&&(google.maps.event.removeListener(this.openInfoHandler_),google.maps.event.removeListener(this.closeInfoHandler_),this.info=null)},_openChanged:function(){this.info&&(this.open?(this.info.open(this.map,this.marker),this.fire('google-map-marker-open')):(this.info.close(),this.fire('google-map-marker-close')))},_mapReady:function(){this._listeners={},this.marker=new google.maps.Marker({map:this.map,position:{lat:parseFloat(this.latitude),lng:parseFloat(this.longitude)},title:this.title,animation:google.maps.Animation[this.animation],draggable:this.draggable,visible:!this.hidden,icon:this.icon,label:this.label,zIndex:this.zIndex}),this._contentChanged(),this._clickEventsChanged(),this._dragEventsChanged(),this._mouseEventsChanged(),this._openChanged(),a.bind(this)()},_clearListener:function(c){this._listeners[c]&&(google.maps.event.removeListener(this._listeners[c]),this._listeners[c]=null)},_forwardEvent:function(c){this._listeners[c]=google.maps.event.addListener(this.marker,c,function(d){this.fire('google-map-marker-'+c,d)}.bind(this))},attributeChanged:function(c){this.marker&&('hidden'===c?this.marker.setVisible(!this.hidden):'draggable'===c?(this.marker.setDraggable(this.draggable),a.bind(this)()):'title'===c?this.marker.setTitle(this.title):void 0)}})})();</script></dom-module><dom-module id="google-map" assetpath="../bower_components/google-map/"><template><style>:host{position:relative;display:block;height:100%;}#map{position:absolute;top:0;right:0;bottom:0;left:0;}</style><google-maps-api id="api" api-key="[[apiKey]]" client-id="[[clientId]]" version="[[version]]" signed-in="[[signedIn]]" language="[[language]]" on-api-load="_mapApiLoaded" maps-url="[[mapsUrl]]"></google-maps-api><div id="map"></div><iron-selector id="selector" multi="[[!singleInfoWindow]]" selected-attribute="open" activate-event="google-map-marker-open" on-google-map-marker-close="_deselectMarker"><slot id="markers" name="markers"></slot></iron-selector><slot id="objects"></slot></template><script>Polymer({is:'google-map',properties:{apiKey:String,mapsUrl:{type:String},clientId:String,latitude:{type:Number,value:37.77493,notify:!0,reflectToAttribute:!0},map:{type:Object,notify:!0,value:null},longitude:{type:Number,value:-122.41942,notify:!0,reflectToAttribute:!0},kml:{type:String,value:null,observer:'_loadKml'},zoom:{type:Number,value:10,observer:'_zoomChanged',notify:!0},noAutoTilt:{type:Boolean,value:!1},mapType:{type:String,value:'roadmap',observer:'_mapTypeChanged',notify:!0},version:{type:String,value:'3.exp'},disableDefaultUi:{type:Boolean,value:!1,observer:'_disableDefaultUiChanged'},disableMapTypeControl:{type:Boolean,value:!1,observer:'_disableMapTypeControlChanged'},disableStreetViewControl:{type:Boolean,value:!1,observer:'_disableStreetViewControlChanged'},fitToMarkers:{type:Boolean,value:!1,observer:'_fitToMarkersChanged'},disableZoom:{type:Boolean,value:!1,observer:'_disableZoomChanged'},styles:{type:Object,value:function(){return{}}},maxZoom:{type:Number,observer:'_maxZoomChanged'},minZoom:{type:Number,observer:'_minZoomChanged'},signedIn:{type:Boolean,value:!1},language:{type:String},clickEvents:{type:Boolean,value:!1,observer:'_clickEventsChanged'},dragEvents:{type:Boolean,value:!1,observer:'_dragEventsChanged'},mouseEvents:{type:Boolean,value:!1,observer:'_mouseEventsChanged'},additionalMapOptions:{type:Object,value:function(){return{}}},markers:{type:Array,value:function(){return[]},readOnly:!0},objects:{type:Array,value:function(){return[]},readOnly:!0},singleInfoWindow:{type:Boolean,value:!1}},behaviors:[Polymer.IronResizableBehavior],listeners:{'iron-resize':'resize'},observers:['_debounceUpdateCenter(latitude, longitude)'],attached:function(){this._initGMap()},detached:function(){this._markersChildrenListener&&(this.unlisten(this.$.selector,'items-changed','_updateMarkers'),this._markersChildrenListener=null),this._objectsMutationObserver&&(this._objectsMutationObserver.disconnect(),this._objectsMutationObserver=null)},_initGMap:function(){this.map||!0!==this.$.api.libraryLoaded||!this.isAttached||(this.map=new google.maps.Map(this.$.map,this._getMapOptions()),this._listeners={},this._updateCenter(),this._loadKml(),this._updateMarkers(),this._updateObjects(),this._addMapListeners(),this.fire('google-map-ready'))},_mapApiLoaded:function(){this._initGMap()},_getMapOptions:function(){var a={zoom:this.zoom,tilt:this.noAutoTilt?0:45,mapTypeId:this.mapType,disableDefaultUI:this.disableDefaultUi,mapTypeControl:!this.disableDefaultUi&&!this.disableMapTypeControl,streetViewControl:!this.disableDefaultUi&&!this.disableStreetViewControl,disableDoubleClickZoom:this.disableZoom,scrollwheel:!this.disableZoom,styles:this.styles,maxZoom:+this.maxZoom,minZoom:+this.minZoom};for(var b in null!=this.getAttribute('draggable')&&(a.draggable=this.draggable),this.additionalMapOptions)a[b]=this.additionalMapOptions[b];return a},_attachChildrenToMap:function(a){if(this.map)for(var c,b=0;c=a[b];++b)c.map=this.map},_observeMarkers:function(){this._markersChildrenListener||(this._markersChildrenListener=this.listen(this.$.selector,'items-changed','_updateMarkers'))},_updateMarkers:function(){var a=Array.prototype.slice.call(Polymer.dom(this.$.markers).getDistributedNodes());if(a.length===this.markers.length){var b=a.filter(function(c){return this.markers&&-1===this.markers.indexOf(c)}.bind(this));if(0===b.length)return void(this._markersChildrenListener||this._observeMarkers())}this._observeMarkers(),this.markers=this._setMarkers(a),this._attachChildrenToMap(this.markers),this.fitToMarkers&&this._fitToMarkersChanged()},_observeObjects:function(){this._objectsMutationObserver||(this._objectsMutationObserver=new MutationObserver(this._updateObjects.bind(this)),this._objectsMutationObserver.observe(this,{childList:!0}))},_updateObjects:function(){var a=Array.prototype.slice.call(Polymer.dom(this.$.objects).getDistributedNodes());if(a.length===this.objects.length){var b=a.filter(function(c){return-1===this.objects.indexOf(c)}.bind(this));if(0===b.length)return void this._observeObjects()}this._observeObjects(),this._setObjects(a),this._attachChildrenToMap(this.objects)},clear:function(){for(var b,a=0;b=this.markers[a];++a)b.marker.setMap(null)},resize:function(){if(this.map){var a=this.latitude,b=this.longitude;google.maps.event.trigger(this.map,'resize'),this.latitude=a,this.longitude=b,this.fitToMarkers&&this._fitToMarkersChanged()}},_loadKml:function(){if(this.map&&this.kml)new google.maps.KmlLayer({url:this.kml,map:this.map})},_debounceUpdateCenter:function(){this.debounce('updateCenter',this._updateCenter)},_updateCenter:function(){if(this.cancelDebouncer('updateCenter'),this.map&&void 0!==this.latitude&&void 0!==this.longitude){var a=+this.latitude;if(isNaN(a))throw new TypeError('latitude must be a number');var b=+this.longitude;if(isNaN(b))throw new TypeError('longitude must be a number');var c=new google.maps.LatLng(a,b),d=this.map.getCenter();d?(d=new google.maps.LatLng(d.lat(),d.lng()),!d.equals(c)&&this.map.panTo(c)):this.map.setCenter(c)}},_zoomChanged:function(){this.map&&this.map.setZoom(+this.zoom)},_idleEvent:function(){this.map?this._forwardEvent('idle'):this._clearListener('idle')},_clickEventsChanged:function(){this.map&&(this.clickEvents?(this._forwardEvent('click'),this._forwardEvent('dblclick'),this._forwardEvent('rightclick')):(this._clearListener('click'),this._clearListener('dblclick'),this._clearListener('rightclick')))},_dragEventsChanged:function(){this.map&&(this.dragEvents?(this._forwardEvent('drag'),this._forwardEvent('dragend'),this._forwardEvent('dragstart')):(this._clearListener('drag'),this._clearListener('dragend'),this._clearListener('dragstart')))},_mouseEventsChanged:function(){this.map&&(this.mouseEvents?(this._forwardEvent('mousemove'),this._forwardEvent('mouseout'),this._forwardEvent('mouseover')):(this._clearListener('mousemove'),this._clearListener('mouseout'),this._clearListener('mouseover')))},_maxZoomChanged:function(){this.map&&this.map.setOptions({maxZoom:+this.maxZoom})},_minZoomChanged:function(){this.map&&this.map.setOptions({minZoom:+this.minZoom})},_mapTypeChanged:function(){this.map&&this.map.setMapTypeId(this.mapType)},_disableDefaultUiChanged:function(){this.map&&this.map.setOptions({disableDefaultUI:this.disableDefaultUi})},_disableMapTypeControlChanged:function(){this.map&&this.map.setOptions({mapTypeControl:!this.disableMapTypeControl})},_disableStreetViewControlChanged:function(){this.map&&this.map.setOptions({streetViewControl:!this.disableStreetViewControl})},_disableZoomChanged:function(){this.map&&this.map.setOptions({disableDoubleClickZoom:this.disableZoom,scrollwheel:!this.disableZoom})},attributeChanged:function(a){this.map&&('draggable'===a?this.map.setOptions({draggable:this.draggable}):void 0)},_fitToMarkersChanged:function(){if(this.map&&this.fitToMarkers&&0<this.markers.length){for(var c,a=new google.maps.LatLngBounds,b=0;c=this.markers[b];++b)a.extend(new google.maps.LatLng(c.latitude,c.longitude));1<this.markers.length&&this.map.fitBounds(a),this.map.setCenter(a.getCenter())}},_addMapListeners:function(){google.maps.event.addListener(this.map,'center_changed',function(){var a=this.map.getCenter();this.latitude=a.lat(),this.longitude=a.lng()}.bind(this)),google.maps.event.addListener(this.map,'zoom_changed',function(){this.zoom=this.map.getZoom()}.bind(this)),google.maps.event.addListener(this.map,'maptypeid_changed',function(){this.mapType=this.map.getMapTypeId()}.bind(this)),this._clickEventsChanged(),this._dragEventsChanged(),this._mouseEventsChanged(),this._idleEvent()},_clearListener:function(a){this._listeners[a]&&(google.maps.event.removeListener(this._listeners[a]),this._listeners[a]=null)},_forwardEvent:function(a){this._listeners[a]=google.maps.event.addListener(this.map,a,function(b){this.fire('google-map-'+a,b)}.bind(this))},_deselectMarker:function(a){var c=this.$.selector.indexOf(a.target);this.singleInfoWindow?this.$.selector.selected=null:this.$.selector.selectedValues&&(this.$.selector.selectedValues=this.$.selector.selectedValues.filter(function(d){return d!==c}))}});</script></dom-module></div><dom-module id="vatsimmap-page"><template><style>:host{display:block;}google-map{position:absolute;top:0;bottom:0;left:0;right:0;}paper-fab{position:absolute;bottom:10px;right:10px;}</style><iron-ajax id="ajax" url="{{_getClientURL()}}" handle-as="json" last-response="{{clients}}"></iron-ajax><google-map additional-map-options="{&quot;mapTypeId&quot;:&quot;satellite&quot;}" disable-default-ui="" fit-to-marker="" api-key="AIzaSyDj4y39JAORYGw4rNcA1y8oVj0m8lNDje4" latitude="40.0955474" longitude="-3.070306" zoom="4" drag-events="true" id="map"><template is="dom-repeat" items="[[clients._items]]"><google-map-marker latitude="{{_getLatitudeFromLocation(item.location)}}" longitude="{{_getLongitudeFromLocation(item.location)}}" draggable="false" title="{{item.callsign}} - {{item.realname}}" icon="circle"></google-map-marker></template></google-map></template><script>class VatsimmapPage extends Polymer.Element{static get is(){return'vatsimmap-page'}static get observers(){return['view_location_change(map.latitude, map.longitude)']}static get properties(){return{lastLatitude:{type:Number,value:0},lastLongitude:{type:Number,value:0},lastZoom:{type:Number,value:0}}}ready(){super.ready(),this.$.map.addEventListener('google-map-drag',a=>{this._mapUpdate(a)}),this.$.map.addEventListener('zoom-changed',a=>{this._mapUpdate(a)}),this._mapUpdate(this.$.map)}_mapUpdate(){var b=!1;2<Math.abs(this.$.map.latitude-this.lastLatitude)&&(this.lastLatitude=this.$.map.latitude,b=!0),2<Math.abs(this.$.map.longitude-this.lastLongitude)&&(this.lastLongitude=this.$.map.longitude,b=!0),1<Math.abs(this.$.map.zoom-this.lastZoom)&&(this.lastZoom=this.$.map.zoom,b=!0),b&&(this.$.ajax.url=this._getClientURL(),this.$.ajax.generateRequest())}_getMapCenterLatitude(){return this.$.map.map?this.$.map.map.getCenter().lat():0}_getMapCenterLongitude(){return this.$.map.map?this.$.map.map.getCenter().lng():0}_getMapViewRadius(){if(this.$.map.map){var a=this.$.map.map.getBounds(),b=this.$.map.map.getCenter();if(a&&b){var c=a.getNorthEast();return google.maps.geometry.spherical.computeDistanceBetween(b,c)}return 1.2e7}return 1.2e7}_getLatitudeFromLocation(a){return parseFloat(a.toString().split(',')[1])}_getLongitudeFromLocation(a){return parseFloat(a.toString().split(',')[0])}_getClientURL(){try{return'https://vatsim-status-proxy.herokuapp.com/clients?where={"location":{"$near":{"$geometry":{"type":"Point","coordinates":[long,lat]},"$maxDistance":range}}}'.replace('lat',this._getMapCenterLatitude()).replace('long',this._getMapCenterLongitude()).replace('range',1.2*parseInt(this._getMapViewRadius()))}catch(a){return console.log(a),'https://vatsim-status-proxy.herokuapp.com/clients'}}}window.customElements.define(VatsimmapPage.is,VatsimmapPage);</script></dom-module></body></html>